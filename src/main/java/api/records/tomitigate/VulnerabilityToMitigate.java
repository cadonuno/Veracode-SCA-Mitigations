package api.records.tomitigate;

import com.fasterxml.jackson.annotation.JsonProperty;
import scaresults.types.TSRV;
import scaresults.types.VulnerabilityMitigationTypeEnum;

import java.util.Optional;

public class VulnerabilityToMitigate extends ToMitigationBase {
    private final String vulnerabilityId;
    private final VulnerabilityMitigationTypeEnum mitigationType;
    private final TSRV tsrv;

    public VulnerabilityToMitigate(@JsonProperty("ApplicationId") String applicationId,
                                   @JsonProperty("MitigationText") String mitigationText,
                                   @JsonProperty("ComponentFileName") String componentFileName,
                                   @JsonProperty("VulnerabilityId") String vulnerabilityId,
                                   @JsonProperty("MitigationType") String mitigationType,
                                   @JsonProperty("AcceptanceText") String acceptanceText,
                                   @JsonProperty("TSRV") TSRV tsrv) {
        super(applicationId, mitigationText, componentFileName, acceptanceText);
        this.mitigationType = VulnerabilityMitigationTypeEnum.getByName(mitigationType);
        this.vulnerabilityId = vulnerabilityId;
        this.tsrv = tsrv;
    }

    public String getVulnerabilityId() {
        return vulnerabilityId;
    }

    public VulnerabilityMitigationTypeEnum getMitigationType() {
        return mitigationType;
    }

    public TSRV getTSRV() {
        return this.tsrv;
    }
}
